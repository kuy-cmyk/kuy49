--[[ 
   WexZ Hub | Debug Loader (Check where it gets stuck)
]]

-- Your main script link (If you change the filename, don't forget to update this)
local MainScriptURL = "https://urlkub.co/Yu3Tqu"

local function LoadWexZ()
    print("-----------------------------------")
    print("⏳ [WexZ] Loader started...")
    
    local scriptData = ""
    
    print("⏳ [WexZ] Step 1: Downloading script...")
    
    local fetchFunc = request or http_request or (http and http.request)
    if fetchFunc then
        local response = fetchFunc({Url = MainScriptURL, Method = "GET"})
        if response and response.StatusCode == 200 then
            scriptData = response.Body
            print("✅ Fetched data via Request successfully!")
        end
    end
    
    if scriptData == "" then
        print("⚠️ Trying to fetch via HttpGet...")
        local success, res = pcall(function() return game:HttpGet(MainScriptURL, true) end)
        if success and res then 
            scriptData = res 
            print("✅ Fetched data via HttpGet successfully!")
        end
    end

    if scriptData ~= "" then
        print("✅ [WexZ] Step 2: Preparing to run script (Code length: " .. tostring(#scriptData) .. ")")
        
        if writefile and loadfile then
            print("⏳ [WexZ] Attempting to run via File Bypass system...")
            local tempName = "WexZ_Sys_" .. tostring(math.random(10000, 99999)) .. ".txt"
            
            local writeSuccess, writeErr = pcall(function() writefile(tempName, scriptData) end)
            if writeSuccess then
                local func, loadErr = loadfile(tempName)
                
                -- Delete the temporary file
                if delfile then pcall(function() delfile(tempName) end) end
                
                if func then 
                    print("✅ [WexZ] Executed successfully! (If it doesn't show up, the obfuscator has issues)")
                    return func() 
                else
                    warn("❌ [WexZ] Failed to load file: " .. tostring(loadErr))
                end
            else
                warn("❌ [WexZ] Failed to write file: " .. tostring(writeErr))
            end
        end

        print("⏳ [WexZ] Switching to direct loadstring...")
        local func, err = loadstring(scriptData)
        if func then 
            print("✅ [WexZ] Executed via Loadstring successfully!")
            return func() 
        else
            warn("❌ [WexZ] Loadstring failed: " .. tostring(err))
        end
    else
        warn("❌ [WexZ] Failed to download main script, please check your GitHub link!")
    end
end

task.spawn(LoadWexZ)
